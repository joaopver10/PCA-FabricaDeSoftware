{% extends 'sidebarPainel.html' %}
{% load static %}
{% block title %}
    Painel do Professor
{% endblock title %}


{% block extra_head %}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/painel.css' %}">
{% endblock %}

{% block content %}
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-6 bg-side">
                    <div class="body-form">
                        {% if messages %}
                            <br>
                            {% for message in messages %}
                                <div class="alert {{message.tags}}">
                                    {{message}}
                                </div>
                            {% endfor %}
                        {% endif %}
                        <p>Dados pessoais do aluno</p>
                        <hr>
                        <form action="{% url 'painel' %}" method="POST"  class="needs-validation" novalidate >
                            {% csrf_token %}
                            <div class="row">
                                <div class="col-md">
                                    <span>Nome:</span>
                                    <input type="text" class="form-control" placeholder="Nome completo" name="nome" required>
                                    <div class="invalid-feedback">Informe o nome</div>
                                </div>
                                <div class="col-md">
                                    <span>E-mail:</span>
                                    <input type="email" class="form-control"  name="email" required>
                                    <div class="invalid-feedback" >Informe o E-mail</div>
                                    <br>
                                    </div>
                                <div class="col-4">
                                    <span>Sexo</span>
                                    <input type="text" class="form-control" name="sexo" required>
                                    <div class="invalid-feedback">Informe o sexo</div>
                                </div>
                            </div>
                                <br>
                                <div class="row">
                                    <div class="col-md">
                                    <span>Data nascimento:</span>
                                    <input type="text" class="form-control date" placeholder="DD/MM/YYYY" name="dataNasc" required>
                                        <span class="invalid-feedback">Informe a Data de nascimento</span>
                                    </div>
                                    <div class="col-md">
                                        <span>Local nascimento:</span>
                                        <input type="text" class="form-control" name="localNasc">
                                </div>
                            </div>
                            <br>
                            <div class="row">

                                <div class="col-md">
                                    <span>Nome do Responsavel:</span>
                                    <input type="text" class="form-control" name="nomeResponsavel" required>
                                    <span class="invalid-feedback">Informe o nome do Responsavel</span>
                                </div>
                                <div class="col-md">
                                    <span>Telefone:</span>
                                    <input type="text" class="form-control tel" placeholder="Com DDD" name="tel" required>
                                    <span class="invalid-feedback">Informe o telefone</span>
                                </div>
                            </div>
                            <br>
                            <p>Endereço</p>
                            <hr>
                            <div class="row">
                                <div class="col-4">
                                    <span>CEP:</span>
                                    <input id="cep" type="text" class="form-control cep" name="cep" required>
                                    <span class="invalid-feedback">Informe o cep</span>
                                </div>
                                <div class="col-md">
                                    <span>Logradouro:</span>
                                    <input id="logradouro" type="text" class="form-control" name="logr" required>
                                    <span class="invalid-feedback">Informe o logradouro</span>
                                </div>
                                <div class="col-3">
                                    <span>Número:</span>
                                    <input id="numero" type="text" class="form-control" name="numero" required>
                                    <span class="invalid-feedback">Informe o numero da casa</span>
                                </div>
                            </div>
                                <div class="row">
                                    <div class="col-md">
                                        <span>Bairro:</span>
                                        <input id="bairro" type="text" class="form-control" name="bairro" required>
                                        <span class="invalid-feedback">Informe o bairro</span>
                                    </div>
                                    <div class="col-md">
                                        <span>Cidade:</span>
                                        <input id="cidade" type="text" class="form-control" name="cidade" required>
                                        <span class="invalid-feedback">Informe a cidade</span>
                                    </div>
                                    <div class="col-md">
                                        <span>UF:</span>
                                        <input id="uf" type="text" class="form-control" name="uf" required>
                                        <span class="invalid-feedback">Informe a sigla do estado</span>
                                    </div>
                                    <div class="col-3">
                                        <span>Complemento:</span>
                                        <input  id="complemento" type="text" class="form-control" name="complemento">
                                    </div>

                                </div>
                                <br>
                                <p>Dados do aluno</p>
                                <hr>
                                <div class="row">
                                    <div class="col-md">
                                        <span>Turma:</span>
                                        <input type="text" class="form-control"  name="turma" required>
                                        <span class="invalid-feedback">Informe a turma</span>
                                        <br>
                                    </div>
                                    <div class="col-md">
                                        <span>Turno:</span>
                                        <input type="text" class="form-control"  name="turno" required>
                                        <span class="invalid-feedback">Informe o turno</span>
                                        <br>
                                    </div>
                                    <div class="col-md">
                                        <span>Ano:</span>
                                        <input type="number" class="form-control"  name="ano" required>
                                        <span class="invalid-feedback">Informe o ano</span>
                                        <br>
                                    </div>
                                </div>

                            <div class="botao">
                                <button type="submit" class="btn btn-primary">Salvar</button>

                                <button type="reset" class="btn btn-secondary">Limpar Campo</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{% static 'js/jquery-3.6.4.min.js' %}"></script>
    <script src="{% static 'js/jquery.mask.min.js' %}"></script>
    <script>
        $('.cep').mask('00000-000');
        var MaskBehavior = function (val) {
            return val.replace(/\D/g, '').length === 11 ? '(00) 00000-0000' : '(00) 0000-00009';
            },
        Options = {
            onKeyPress: function(val, e, field, options) {
               field.mask(MaskBehavior.apply({}, arguments), options);
            }
        }
        $('.tel').mask(MaskBehavior, Options);

        var MaskBehav = function (val) {
            document.querySelector('.date').value;
            return val.replace(/\D/g, '').length === 10 ? '00/00/0000' : '00/00/0000';
            },
        Options = {
            onKeyPress: function(val, e, field, options) {
               field.mask(MaskBehav.apply({}, arguments), options);
            }
        }
        $('.date').mask(MaskBehav, Options);

         function limparform() {
             document.getElementsByClassName('form-control').value = '';
         }
		$("#cep").focusout(function(){
			//Início do Comando AJAX
			$.ajax({
				//O campo URL diz o caminho de onde virá os dados
				//É importante concatenar o valor digitado no CEP
				url: 'https://viacep.com.br/ws/'+$(this).val()+'/json/',
				//Aqui você deve preencher o tipo de dados que será lido,
				//no caso, estamos lendo JSON.
				dataType: 'json',
				//SUCESS é referente a função que será executada caso
				//ele consiga ler a fonte de dados com sucesso.
				//O parâmetro dentro da função se refere ao nome da variável
				//que você vai dar para ler esse objeto.
				success: function(resposta){
					//Agora basta definir os valores que você deseja preencher
					//automaticamente nos campos acima.
					$("#logradouro").val(resposta.logradouro);
					$("#complemento").val(resposta.complemento);
					$("#bairro").val(resposta.bairro);
					$("#cidade").val(resposta.localidade);
					$("#uf").val(resposta.uf);
					//Vamos incluir para que o Número seja focado automaticamente
					//melhorando a experiência do usuário
					$("#numero").focus();
				}
			});
		});


         (function () {
              'use strict'

              var forms = document.querySelectorAll('.needs-validation')
              Array.prototype.slice.call(forms)
                .forEach(function (form) {
                  form.addEventListener('submit', function (event) {
                    if (!form.checkValidity()) {
                      event.preventDefault()
                      event.stopPropagation()
                    }

                    form.classList.add('was-validated')
                  }, false)
                })
            })()
    </script>
{%endblock%}

